@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
@model List<ESTA.ViewModels.DisplayEvents>
<div class="slider-area">
    <div class="page-title">
        <div class="single-slider slider-height slider-height-breadcrumb d-flex align-items-center" style="background-image: url(/template/img/inner-bg.png);">
            <div class="container">
                <div class="row">
                    <div class="col-xl-12">
                        <div class="slider-content slider-content-breadcrumb text-center">
                            <h1 class="white-color f-700">News</h1>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@if (Model.Count > 0)
{
    <div class="blog-grid-area pt-50 pb-50">
        <div class="container">
            <div class="blog-grid-list">
                <div id="cards" class="row">
                    @{
                        await Html.RenderPartialAsync("_renderEvent", new ESTA.ViewModels.DisplayEventPartial()
                {
                    Events = Model
                });
                    }
                </div>
            </div>
        </div>
    </div>
    @if (ViewBag.EventCount)
    {
        <div id="MoreBtn" class="courses-view-more-area mt-20 mb-30 text-center">
            <div class="row">
                <div class="col-xl-12">
                    <div class="courses-view-more-btn">
                        <button onclick="LoadMoreEvents()" class="btn gray-border-btn"><span class="">view more</span></button>
                    </div>
                </div>
            </div>
        </div>
    }
}
else
{
    <div>
        <h2>There's no events</h2>
    </div>
}



@section Scripts{
    <script>
        var page = 0
        function LoadMoreEvents() {
            $.ajax({
                type: 'get',
                url: '/EventsNews/GetEventsPage',
                data: {
                    page: ++page
                },
                success: function (data) {
                    $('#cards').append(data);
                    checkMoreEvents();
                },
                error: function (data) {
                    console.log(data)
                }
            });
        }

        function checkMoreEvents() {
            $.ajax({
                type: 'get',
                url: '/EventsNews/CheckMoreEvents',
                data: {
                    page: page
                },
                success: function (data) {
                    if (!data) {
                        $('#MoreBtn').hide();
                    }
                },
                error: function (data) {
                    console.log(data)
                }
            });
        }
    </script>
    }
